import styles from '../css/Tab.module.css';

<Tabs>
  <Tab eventKey="project" className={styles.paddingTop} title="Project">
    The data for this tab should be know prior to the initial site visit.

    *The Installer inputs below are all optional, although you will want to 
    fill in at least one for the report.*

    ##### Installer
    <StringInput label="Technician Name" path="installer.name" />
    <StringInput label="Installation Company" path="installer.company_name" />
    <StringInput label="Company Address" path="installer.mailing_address" />
    <StringInput label="Company Phone" path="installer.phone" />
    <StringInput label="Company Email" path="installer.email" />

    ##### Project Address
    <StringInput label="Street Address" path="location.street_address" />
    <StringInput label="City" path="location.city" />
    <USStateSelect label="State" path="location.state" />
    <StringInput label="Zip Code" path="location.zip_code" />
  </Tab>

  <Tab eventKey="assessment" style={{paddingTop:"1rem"}} title="Assessment">
    The data for this tab should be collected during the initial site visit.

    ##### Building
    <PhotoInput id="building_number_photo" label="Building Number – Photo">
      Provide a photo of the building that shows the street number.
    </PhotoInput>

    ##### Old Water Heater
    <PhotoInput id="old_nameplate_photo" label="Old Water Heater Nameplate – Photo">
      For some jurisdictions, rebates for an HPWH might be conditioned on not only the
      efficiency specifications of the HPWH but also the fuel type of the existing water
      heater the HPWH is replacing. For jurisdictions where this applies, provide
      a photo of the nameplate showing the model number,
      fuel type, and the serial number of the old water heater.
    </PhotoInput>

    ##### HPWH Space Evaluation
    <Collapsible header="HPWH Space Evaluation — Instructions">
      The successful installation of a heat pump water heater (HPWH) begins in the planning
      stage by assessing whether the location where the HPWH will be installed is suitable.
      The space around the HPWH must be:
      1. Large enough to meet the minimum HPWH air volume requirement of 700 ft<sup>3</sup>
      2. Where some compressor and fan noise (50 to 65 dB, normal conversation loudness) is
      acceptable
      3. Where the cooled air exhausted from the HPWH (approximately a half-ton) is acceptable or desirable
      4. More than 8 ft line-of-sight from a thermostat to prevent the cool air from affecting the thermostat
      5. Not dusty, or where a significant amount of dust is generated
      6. Tall enough (~12” taller than the tank height, ~76” if < 65 gals to ~86” if &ge; 80
      gals) to allow the filter in the HPWH to be periodically accessed for cleaning
      7. Where there is access to a drain, drain line, or utility sink for condensate
      8. In the 40°F–125°F (4.4°C–51°C) temperature range year-round

      It is possible to also meet the air volume requirement of the HPWH by installing it next
      to a louvered door, or ducting the supply, exhaust, or both the supply and the exhaust
      of the HPWH to an adjacent space. It is also possible to install a condensate pump where
      a drain located below the elevation of the HPWH’s condensate outlet is not available.

      You may find the following Space Air Volume Calculator useful in determining the volume to be 
      entered in the "Space Air Volume" input below.

| Space Air Volume Calculator                                                                                                                                                                                                                                            |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <NumberInput label="Length (ft)" min={0} path="volume_calculator.length"  />                                                                                                                                                            |
| <NumberInput label="Width (ft)" min={0} path="volume_calculator.width"  />                                                                                                                                                                                      |
| <NumberInput label="height (ft)" min={0} path="volume_calculator.height" />                                                                                                                                                                                    |
| Air Volume = {props.data.volume_calculator?.length} x {props.data.volume_calculator?.width} x {props.data.volume_calculator?.height} = {props.data.volume_calculator?.length * props.data.volume_calculator?.width * props.data.volume_calculator?.height} ft<sup>3</sup> |

    </Collapsible>

    <NumberInput label="Space Air Volume (ft&#179;)" min={0} path="space_air_volume" />

    <PhotoInput id="hpwh_location_photo" label="HPWH Location – Photo">
      Provide a wide-angle photo of the space where the HPWH will be installed to best capture the space requirements
      from the "HPWH Space Evaluation - Instructions" above.
    </PhotoInput>

    <PhotoInput id="adjacent_space_photo" label="Adjacent Space – Photo">
      If adjacent space will be used to supply air to meet the minimum air volume requirement for the HPWH, then provide 
      a photo of the adjacent space.
      This is applicable to HPWH installations that will utilize a louvered door or ducting to meet the minimum air volume 
      requirement.
    </PhotoInput>

    <Collapsible header="HPWH & Building Science">
      Be mindful about the effects of pressurizing or depressurizing a zone from supply only 
      ducting or exhaust only ducting a HPWH. Pressurizing or depressurizing a zone could result 
      in pulling air containing moisture into walls or rim/band joists where the air reaches 
      dewpoint and condenses to cause water damage or mold problems. Depressurizing a zone 
      could also cause a naturally drafted combustion appliance in the same zone to fail to 
      draft properly.
  
      Also be mindful about the humidity levels of the space the HPWH is located in. For example, 
      if the exhaust air stream is directed against a wall or window on a hot and humid day, 
      the cool air could possibly lower the temperature of the surface to the point of dewpoint 
      and cause moisture damage.
    </Collapsible>

  </Tab>
  <Tab eventKey="installation" style={{paddingTop:"1rem"}} title="Installation">
    ##### HPWH Installation

    <DateInput label="Installation Date" path="install_date" />

    <Collapsible header="HPWH Installation - Instructions">
      - Check the water pressure to the house, and ensure it is between 45 and 80 psi.
      If it is above 80 PSI, a whole house water pressure reducing/regulating valve should
      be installed to protect the water heater and water fixture valves in the house.
      - Check that the floor can support the weight of the HPWH when filled with water.
      This is especially important if the HPWH selected has a larger storage capacity than
      the original one.

  | Capcity (gal)| Filled Weight (lbs) | 
  | --- | --- | 
  | 50  | 573 | 
  | 66  | 796 | 
  | 80  | 921 | 

      - Install the HPWH into a drain pan to protect the surrounding location from water
      damage if a leak occurs. Install the leak detection sensor into the drain pan if the
      HPWH includes one.
      - Rotate the HPWH during installation so that the exhaust does not face a solid wall.
      The exhaust of the HPWH must be more than the HPWH manufacturer’s minimum required
      distance from a solid wall, usually 7 inches. If installing into a closet with a
      louvered door or high and low air grill, there is a maximum distance, typically around
      12 inches, between the exhaust and the louvers, refer to the manufacturer’s specific
      instructions. The louvers on the door must extend to the bottom of the door to allow
      the cold air to fall out.
      - Replace the thermal expansion tank when replacing the water heater, expansion tanks
      typically last 5 to 10 years. Adjust the pre-charge pressure of the thermal expansion
      tank to match the home’s water pressure using a tire pump. This 2009 Watts Water video
      shows how to do this step. Write down the pre-charge pressure onto the tank. A thermal
      expansion tank is not needed if the water heater is connected to a well pressure tank
      and there are no check valves to prevent backflow.
      - Follow local code requirements on dielectric unions and anti-siphon vacuum relief
      valve requirements. Flexible supply lines made of corrugated copper, corrugated
      stainless steel, and braided stainless steel often have dielectric sleeves in the
      design.
      - External heat traps are not if the HPWH has a built-in heat trap. To determine the
      presence of in-built heat traps, look at the cold water inlet and hot water outlet for
      plastic or metal hardware that captures a ball or rubber flap as shown in the examples
      below.

      <Figure src="/images/hpwh/heattraps.png" />

      - Do not make any soldered inlet and outlet connections while connected to the water
      heater, the built-in heat traps are plastic
      - Insulate the first 5 ft of hot water pipe to R-3 or more. If a recirculation pump is
      installed insulate all hot water and recirculation piping. Some HPWH rebates may
      require the recirculation pump to operate on a timer or demand button to reduce standby
      energy loss penalties.
      - The pressure relief valve discharge must terminate no more than 6 inches above the
      floor surface to a waste receptor or floor drain to prevent hot water discharge from
      being directed onto a building occupant that may be nearby.
      - The condensate is piped to a drain, sink, or condensate pump.
      - Install earthquake straps if required by local code to the bottom 1/3 and top 1/3 of
      the tank, do not install the straps to the heat pump portion.
      - Set the HPWH to hybrid mode.
      - Set the HPWH temperature to no more than 120 F. Setting temperatures higher than
      this requires a thermostatic mixing valve at the water heater to prevent scalding.
    </Collapsible>

    <PhotoInput id="completed_installed_photo" label="Completed Installation – Photo">
      Provide a wide-angle photo of the completed HPWH installation showing the exhaust,
      insulated hot water line, pressure relief valve discharge, and condensate drain line.
    </PhotoInput>

    <PhotoInput id="nameplate_photo" label="Nameplate – Photo">
      Provide a close-up photo of the nameplate of the installed system showing the
      model number and serial number.
    </PhotoInput>

    <PhotoInput id="mode_photo" label="HPWH Screen with Mode – Photo">
      Prove a close-up photo of the HPWH Screen showing the mode.
    </PhotoInput>

    <PhotoInput id="cta_2045_module_photo" label="CTA-2045 Module – Photo">
      Provide a photo of the CTA-2045 Module if installed.
    </PhotoInput>

    ##### HPWHW Post-Installation
    <Collapsible header="HPWH Post-Install – Instructions">
      Inform the homeowner on how to access the air filter to check and clean as needed. A
      filter check should be performed every three months. If dirty, clean the air filter by
      vacuuming the dust and washing with mild soap and detergent. Thoroughly dry before
      reinstalling.

      It is also suggested to inform the homeowner on how to perform the following annual
      water heaters checks that are not specific to a HPWH:
      1. Check the pressure relief valve by placing a small bucket at the end of the
      discharge pipe and pull and rotate the handle to open the valve for a few seconds to
      ensure it opens fully. When performing this check, stand back and wear closed-toe shoes
      to protect your feet from hot water. Once you begin to rotate the handle back close it
      should snap close by itself. The discharge pipe should stop dripping shortly. If it
      continues to drip, call a plumber to have the pressure relief valve replaced.
      2. Check the expansion tank. Remove the cap and briefly press in the Schrader valve to
      check that air (and not water) is expelled. If water is expelled the thermal expansion
      tank has failed and will need replacement, call a plumber to have the thermal expansion
      tank replaced. If air is expelled, the thermal expansion tank is working as expected.
      The pre-charge pressure of the thermal expansion tank can be checked by turning off the
      cold water main, opening a faucet to relieve the water pressure in the pipes, then
      checking the pre-charge with a tire pressure gauge. Adjust as needed using a tire pump
      to match the pressure written on the tank. Reinstall the cap on the Schrader valve if
      one is present, and reopen the cold water main shutoff valve.
    </Collapsible>

    <Collapsible header="Post-Installation Combustion Safety Testing">
      Post installation combustion safety testing is required for a HPWH that is replacing a 
      combustion water heater that draws air from the conditioned space and the zone will have 
      a naturally drafted combustion appliance remaining after the HPWH is installed. Please 
      use the combustion safety testing documentation workflow to document the combustion 
      safety testing.
    </Collapsible>

  </Tab>
  <Tab eventKey="report" style={{paddingTop:"1rem"}} title="Report">
    <PrintSection label="Print Report">
    ---
    # Heat Pump Water Heater Quality Installation Report

    **Installer**:<br/>
    {props.data.installer?.name ? <span>&nbsp;&nbsp;&nbsp;&nbsp;{props.data.installer?.name}</span> : null}<br/>
    {props.data.installer?.company_name ? <span>&nbsp;&nbsp;&nbsp;&nbsp;{props.data.installer?.company_name}</span> : null}<br/>
    {props.data.installer?.mailing_address ? <span>&nbsp;&nbsp;&nbsp;&nbsp;{props.data.installer?.mailing_address}</span> : null}<br/>
    {props.data.installer?.phone ? <span>&nbsp;&nbsp;&nbsp;&nbsp;{props.data.installer?.phone}</span> : null}<br/>
    {props.data.installer?.email ? <span>&nbsp;&nbsp;&nbsp;&nbsp;{props.data.installer?.email}</span> : null}<br/>

    **Installation Date:** <DateStr date={props.data.install_date}/>

    **Installation Address:** {props.data.location?.street_address}, {props.data.location?.city}, {props.data.location?.state} {props.data.location?.zip_code}
   

    <Photo id="building_number_photo" label="Building Number" required>
      A photo of the building showing the building number.
    </Photo>

    ## About the Report
    
    The photos in this report are intended to document the critical details of upgrading to a heat pump water heater, from 
    pre-installation steps to the completed HPWH 
    installation. 

    *The photos and information in this report use timestamps and geotags to prevent the reuse of photos 
    from an unrelated project.  The customer is encouraged 
    to retain a copy of this report which could help add value to a home sale and foster buyer confidence in 
    the quality of the energy efficiency upgrade work that was performed.*  

    The report includes the following quality installation photos:    
    1. A (wide-angle) photo of the space where the HPWH is/will be installed
    2. A photo of the adjacent space if an adjacent space supplying air to meet the air volume 
       requirement of the HPWH is used via a louvered door, high and low air grill, or ducting
    3. A photo of the nameplate of the old water heater.
    4. A wide-angle photo of the completed HPWH installation
    5. Photo of the HPWH nameplate
    6. Photo of the HPWH screen showing the mode
    7. Photo of the utility energy management communication module CTA-2045 module if one is installed

    ## HPWH Space Evaluation
    The successful installation of a heat pump water heater (HPWH) begins in the planning
    stage by assessing whether the location where the HPWH will be installed is suitable.
    The space around the HPWH must be:
    1. Large enough to meet the minimum HPWH air volume requirement of 700 ft<sup>3</sup>
    2. Where some compressor and fan noise (50 to 65 dB, normal conversation loudness) is
    acceptable
    3. Where the cooled air exhausted from the HPWH (approximately a half-ton) is acceptable or desirable
    4. More than 8 ft line-of-sight from a thermostat to prevent the cool air from affecting the thermostat
    5. Not dusty, or where a significant amount of dust is generated
    7. Tall enough (~12” taller than the tank height, ~76” if < 65 gals to ~86” if &ge; 80
    gals) to allow the filter in the HPWH to be periodically accessed for cleaning
    7. Where there is access to a drain, drain line, or utility sink for condensate
    8. In the 40°F–125°F (4.4°C–51°C) temperature range year-round

    It is possible to also meet the air volume requirement of the HPWH by installing it next
    to a louvered door, or ducting the supply, exhaust, or both the supply and the exhaust
    of the HPWH to an adjacent space. It is also possible to install a condensate pump where
    a drain located below the elevation of the HPWH’s condensate outlet is not available.

    <Photo id="hpwh_location_photo" label="1. HPWH Location – Photo" required>
      This wide-angle photo helps document that the HPWH Space Evaluation conditions 1-8 have been met.
    </Photo>

    <Photo id="adjacent_space_photo" label="2. Adjacent Space – Photo">
      This photo shows the adjacent space that will supply air to meet the air volume requirement 
      for the HPWH. This is applicable to HPWH installations that will utilize a louvered door or ducting 
      to meet air volume requirements.
    </Photo>

    {
      props.data.space_air_volume
      ? <p><strong>Air Volume of the Space:</strong> {props.data.space_air_volume} ft<sup>3</sup></p> 
      : null
    }
  
    {
      props.metadata?.attachments?.old_nameplate_photo
      ? <>
          <h2>Old Hot Water Heater</h2>
          <Photo id="old_nameplate_photo" label="3. Old Water Heater Nameplate – Photo">
            This photo shows the name plate of the old water heater. It may be used for rebate purposes
            or to determine the energy savings.
          </Photo>
        </>
      : null 
    }

    ## Installation Day Photos
    <Photo id="completed_installed_photo" label="4. Completed Installation – Photo" required>
      This wide-angle photo shows the completed HPWH installation including the exhaust,
      insulated hot water line, pressure relief valve discharge, and condensate drainline.
    </Photo>

    <Photo id="nameplate_photo" label="5. Nameplate – Photo" required>
      This close-up photo of the nameplate of the installed system shows the
      model number and serial number. A correctly-sized water heater is important for
      providing enough hot water while also being efficient.
    </Photo>

    <Photo id="mode_photo" label="6. HPWH Screen with Mode – Photo" required>
      This close-up photo shows the mode seeting of the HPWH.
    </Photo>

    <Photo id="cta_2045_module_photo" label="7. CTA-2045 Module – Photo">
      This photo shows the installed CTA-2045 Module. This module is used by the electric utility
      to manage peak-time energy usage.
    </Photo>


    ## HPWHW Post-Installation
    The HPWH has an air filter that must be checked and cleaned every 3 months. 
    If dirty, clean the air filter by
    vacuuming the dust and washing with mild soap and detergent. Thoroughly dry before
    reinstalling.

    The following HPWH checks should be performed annually:
    1. Check the pressure relief valve by placing a small bucket at the end of the
    discharge pipe and pull and rotate the handle to open the valve for a few seconds to
    ensure it opens fully. When performing this check, stand back and wear closed-toe shoes
    to protect your feet from hot water. Once you begin to rotate the handle back close it
    should snap close by itself. The discharge pipe should stop dripping shortly. If it
    continues to drip, call a plumber to have the pressure relief valve replaced.
    2. Check the expansion tank. Remove the cap and briefly press in the Schrader valve to
    check that air (and not water) is expelled. If water is expelled the thermal expansion
    tank has failed and will need replacement, call a plumber to have the thermal expansion
    tank replaced. If air is expelled, the thermal expansion tank is working as expected.
    The pre-charge pressure of the thermal expansion tank can be checked by turning off the
    cold water main, opening a faucet to relieve the water pressure in the pipes, then
    checking the pre-charge with a tire pressure gauge. Adjust as needed using a tire pump
    to match the pressure written on the tank. Reinstall the cap on the Schrader valve if
    one is present, and reopen the cold water main shutoff valve.
  
    ## General HPWH Information
    An illustration of how a HPWH works is shown below.

    <Figure src="/images/hpwh/hpwh_components.jpeg">
      The components in a common HPWH (BASC 2015)
    </Figure>

    The heat pump uses 1/3 to 1/4 of the electricity to deliver the same heat into the water in the tank as
    an electric resistance element, but requires more time to do it.
    Most HPWHs have electric resistencce elements to provide supplemental heat in certain modes.
    The HPWH will operate less efficiently when the electric resistance elements are used
    to provide supplemental heat. If the typical hot water demands are mostly satisfied by
    the stored hot water in the tank, then it does not affect user comfort whether the HPWH
    replenishes the heat in the tank quickly but less efficiently using the electric resistence elements
    or slower but much more
    efficiently using the heat pump.
    </PrintSection>
  </Tab>
</Tabs>
